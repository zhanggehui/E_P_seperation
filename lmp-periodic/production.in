units           real
boundary        p p p

pair_style      lj/cut/coul/long 10.0
pair_modify     shift yes mix geometric
kspace_style    pppm 1.0e-05

atom_style      full
bond_style      harmonic
angle_style     harmonic
special_bonds   lj/coul 0.0 0.0 0.5

read_data       ../GO.data

group           gra type  1:3

fix             freeze gra setforce 0 0 0
min_style       sd
minimize        0.0 1.0e-8 2000 20000

fix             nvt all nvt temp 300 300 100.0
run             2000000
write_dump all custom nvtequ.dump id type x y z vx vy vz ix iy iz
unfix           nvt

group           OW type 7
variable        n_OW equal count(OW)
variable        target_p equal count(OW)
variable        area equal lx*lz
variable        p_ratio equal 1.013*6.022*1e-5/4.186
variable        add_f equal v_target_p*v_p_ratio*v_area/v_n_OW

fix             push_OW OW setforce 0 0 $(v_add_f)
fix             nvt all nvt temp 300 300 100.0
run             2000
